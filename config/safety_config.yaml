# Safety and Authorization Configuration
safety:
  # Authorization Settings
  authorization:
    # Require authorization token for all scans
    required: true
    # Token expiration in hours
    token_expiration: 24
    # Require signed authorization document
    require_signed_document: true

  # Scope Validation
  scope:
    # Whitelist of allowed IP ranges (CIDR notation)
    allowed_ip_ranges:
      - "192.168.0.0/16"
      - "10.0.0.0/8"
      - "172.16.0.0/12"

    # Whitelist of allowed domains
    allowed_domains:
      - "*.example.com"
      - "testsite.local"

    # Blacklist of forbidden targets
    blacklist:
      # Government domains
      - "*.gov"
      - "*.mil"
      # Critical infrastructure
      - "*.edu"
      - "*.bank"
      # Cloud providers (unless explicitly authorized)
      - "*.amazonaws.com"
      - "*.azure.com"
      - "*.googlecloud.com"

  # Rate Limiting
  rate_limit:
    # Maximum requests per target per minute
    requests_per_minute: 60
    # Maximum concurrent scans per user
    max_concurrent_scans: 3
    # Cooldown period between scans (seconds)
    scan_cooldown: 60

  # Audit Logging
  audit:
    # Enable comprehensive audit logging
    enabled: true
    # Log file location
    log_file: "logs/audit.log"
    # Log level: DEBUG, INFO, WARNING, ERROR
    log_level: "INFO"
    # Log retention days
    retention_days: 90
    # Include sensitive data in logs (not recommended for production)
    include_sensitive: false

  # Emergency Controls
  emergency:
    # Enable kill switch
    kill_switch_enabled: true
    # Require human approval for destructive actions
    require_approval_for_destructive: true
    # Dry run mode (no actual execution)
    dry_run: false

  # Sandbox Settings
  sandbox:
    # Isolate all tool executions in containers
    enabled: true
    # Network isolation
    network_isolation: true
    # File system isolation
    filesystem_isolation: true
    # Resource limits
    memory_limit: "2g"
    cpu_limit: 2

  # Compliance
  compliance:
    # Terms of service acceptance required
    require_tos_acceptance: true
    # GDPR compliance mode
    gdpr_mode: true
    # Data retention policy (days)
    data_retention_days: 30
